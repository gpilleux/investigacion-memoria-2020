# [Attack2vec: Leveraging Temporal Word Embeddings to Understand the Evolution of Cyberattacks](https://www.usenix.org/system/files/sec19-shen.pdf)
## TL-DR

1. Uses temporal word embeddings. Effective way to study how attack steps are exploited in the wild and how they evolve.
2. It considers sequences of security events as short sentences and phrases in a special language.
3. ATTACK2VEC uses NLP. Word frequency in natural language follows a power-law distribution. **Condition** security events must follow power-law distribution. 
4. ATTACK2VEC can be used to understand the emergence, the evolution, and the characteristics of attack steps in relation to the wider context in which they are exploited.
5. ATTACK2VEC can be used to identify emerging attack campaigns several weeks before they are publicly disclosed.
6. ATTACK2VEC was able to flag an attack as emerging in the wild 72 weeks before it was actually discussed by security researchers.

## Key Concepts
1. Common Vulnerabilities and Exposures (CVEs)
2. Security event. Definition of each alert generated by the IPS.
3. Point-wise mutual information (PMI). Word association measure.

## Abstract
ATTACK2VEC is a system that uses **temporal word embeddings** to model how attack steps are exploited in the wild and track how they evolve. It's effective in monitoring the emergence of **new attack strategies** in the wild and in **flagging** which attack steps are often used together by attackers.

ATTACK2VEC provides a useful tool for researchers and practitioners to better understand cyber attacks and their evolution, and use this knowledge to improve situational awareness and develop **proactive defenses**.

It was tested in a dataset of billions of security events from a **Symantec's** Intrusion Prevention System (IPS) (2 years collecting).

### Challenges
1. Due to the noise in the IPS there are no obvious event relationships reflected in the telemetry
2. Attacks change over time, consequently, the context of a security event and its relationship with other attack steps may drift.


## Specifics
They define the sequence of attack steps that are commonly performed together with an attack step of interest as its **context**.
Looking at attack steps in relation to each other can provide with invaluable insights into the modus operandi of attackers, highlighting important trends in the way attacks are conducted and prompt proactive defenses.

Having a system able to track significant changes in the context associated to a security event could be used to perform a timely **retraining** of such systems.

The embedding is calculated on an attack step by considering an entire attack sequence as a sentence, and each step as a word. Upon encoding the relationship between attack steps within the vector space, we can quantitatively study the attack steps appearing in similar contexts in the latent space and understand them in a more meaningful and measurable way.

Our system takes a stream of security events and computes their context by using temporal word embeddings
we can identify when a certain CVE starts getting exploited, when its exploitation becomes stable, and when attackers change strategy in exploiting it.

For example, we were able to identify a variant of the Mirai botnet that was scanning the Internet attempting to exploit a CVE relative to Apache Struts, together with IoT-related exploits over 72 weeks before this variant was officially identified


## Methodology
1. Context Windows
	* The context is a sliding window, centered in a security event.
	* Reduces noise product of concurrency.
2. Temporal Security Event Embedding
	* Adapted from dynamic word embeddings [[48]](https://www.usenix.org/system/files/sec19-shen.pdf#page=18&zoom=100,424,830).
	* PMI. To calculate weights between two security events given a contextual window *c* and an observation period *t*. PMI measures the extent to which the events co-occur more than by *chance* or are independent.
	* The assumption is that if two events co-occur more than expected under independence there must be some kind of relationship between them.
	* These characteristics enables the use of word embedding techniques to encode latent forms of security events
	* Uses grid search to identify the best parameters $\alpha$, $\beta$, *c*, *d*.
3. ATTACK2VEC Architecture. 3 phases:
	1. Data collection and preprocessing
		* Input: timestamped security event data generated from millions of machines.
		* Constructs sequence of events ordered by timestamps $s_j$.
		* Output: $S_t = \{s_1^t,..., s_i^t,..., s_z^t\}$, with *z* the number of machines.
	2. Temporal event embedding
		* Input $S$ and encodes latent forms of security events
		*  Each security event in timestampt *t* is a *d-dimensional* vector representation $\eta_{e_i}^t$
		* Aligned across time
	3. Event tracking and monitoring 
		* Metrics to detect changes, to identify event trends, to monitor how security events are exploited in the wild.

## Evaluation
1. Evaluation Metric
2. Change Detection
3. Trend Identification
4. Event Evolution
5. System Performance
6. End-to-end Evaluation of ATTACK2VEC

## Limitations
ATTACK2VEC relies on a dataset of pre-labeled security events to generate insights and understand their evolution. An inherent limitation of this type of data is that an event **can be detected only if it belongs to a known attack vector**.

## Related Work
* [[5]](https://www.usenix.org/system/files/sec19-shen.pdf#page=17&zoom=100,72,314) An empirical study of zero-day attacks in the real world. In ACM CCS, 2012.
*  [25] and [22] have theoretically proven that the skip-gram negative sampling (SGNS) used by the word2vec model can be viewed as explicitly (implicitly) factorizing a word co-occurrence matrix.
* [48] identified the solution of the following joint optimization problem as the temporal embedding results.
* [27] addressed concept drift in Web application security
* [40] demonstrated that recurrent neural networks (RNNs) can be leveraged to predict the specific steps (i.e., vulnerability that may be exploited) that would be taken by an adversary when performing an attack
* [45] summarized the current state of the art in the area of distributed and collaborative intrusion detection. Focuses on understanding the emergence, the evolution, and the characteristics of attack steps in relation to the wider context in which they are exploited.
* [29]. The authors carried out a longitudinal analysis of a large corpus of cyber threat descriptions. It quantifies the severity and types (e.g., worms, viruses and trojans) of 12,400 threats detected by Symantec’s AV and 2,700 attacks detected by Symantec’s IPS

